/**
 * UMC Angular Google Analytics - Easy tracking for your AngularJS application
 * @version v0.1.8 - 2015-04-16
 * @link http://github.com/laffer1/angular-google-analytics
 * @author Julien Bouquillon <julien@revolunet.com>,Luke Palnau <lpalnau@umich.edu>,Lucas Holt <lholt@umich.edu>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
angular.module("umc-angular-google-analytics",[]).provider("Analytics",function(){"use strict";var a,b=!1,c=!0,d="",e="analytics.js",f="$routeChangeSuccess",g=!1,h=!1,i=!1,j=!1,k=!1,l=!1;this.trackers=[],this._logs=[],this.setAccount=function(a){return 0===this.trackers.length?this.trackers.push({code:a,name:""}):this.trackers[0]={code:a,name:""},!0},this.trackPages=function(a){return c=a,!0},this.trackPrefix=function(a){return d=a,!0},this.setDomainName=function(b){return a=b,!0},this.setFilename=function(a){return e=a,!0},this.setPageEvent=function(a){return f=a,!0},this.trackEcommerce=function(a){return g=a,!0},this.trackEnhancedEcommerce=function(a){return k=a,!0},this.trackDisplayFeatures=function(a){return i=a,!0},this.addTracker=function(a,b){if(null===b||""===b)return void(this.trackers[0].code=a);for(var c=1;c<this.trackers.length;c++)if(this.trackers[c].name===b)return void(this.trackers[c].code=a);this.trackers.push({code:a,name:b})},this.getTrackers=function(){return this.trackers},this.$get=["$document","$rootScope","$location","$window",function(m,n,o,p){this._createScriptTag=function(){if(0!==this.trackers.length){p.GoogleAnalyticsObject="__gaTracker",angular.isUndefined(p.__gaTracker)&&(p.__gaTracker=function(){angular.isUndefined(p.__gaTracker.q)&&(p.__gaTracker.q=[]),p.__gaTracker.q.push(arguments)},p.__gaTracker.l=1*new Date);var d={};a&&(d.cookieDomain=a),p.__gaTracker("create",this.trackers[0].code);for(var f=1;f<this.trackers.length;f++)p.__gaTracker("create",this.trackers[f].code,{name:this.trackers[f].name});if(g&&!h&&(p.__gaTracker("require","ecommerce","ecommerce.js"),h=!0,this._log("loadGA","ecommerce")),k&&!l&&(p.__gaTracker("require","ec","ec.js"),l=!0,this._log("loadGA","ec")),i&&!j){p.__gaTracker("require","displayfeatures","displayfeatures.js"),j=!0;for(var q=1;f<this.trackers.length;q++)p.__gaTracker(this.trackers[q].name+".require","ecommerce","ecommerce.js");this._log("loadGA","displayfeatures")}c&&this._trackPage(o.path(),n.pageTitle),function(){var a=m[0].createElement("script");a.type="text/javascript",a.async=!0,a.src="//www.google-analytics.com/"+e;var b=m[0].getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}(),b=!0}},this._log=function(){this._logs.push(arguments)},this._trackPage=function(a,b){if(!angular.isUndefined(p.__gaTracker)){if(i&&!j){p.__gaTracker("require","displayfeatures","displayfeatures.js"),j=!0;for(var c=1;c<this.trackers.length;c++)p.__gaTracker(this.trackers[c].name+".require","ecommerce","ecommerce.js");this._log("loadGA","displayfeatures")}angular.isUndefined(a)&&(a=o.path());var e=d+a;""!==e&&"/"!==e.charAt(0)&&(e="/"+e);var f={page:e};angular.isUndefined(b)&&angular.isDefined(n.pageTitle)&&(b=n.pageTitle),angular.isDefined(b)&&""!==b&&(f.title=b),p.__gaTracker("send","pageview",f);for(var g=1;g<this.trackers.length;g++)p.__gaTracker(this.trackers[g].name+".send","pageview",f);this._log("pageview",arguments)}},this._trackEvent=function(a,b,c,d){angular.isUndefined(p.__gaTracker)||(p.__gaTracker("send","event",{eventCategory:a,eventAction:b,eventLabel:c,eventValue:d}),this._log("event",arguments))},this._addTrans=function(a,b,c,d,e){angular.isUndefined(p.__gaTracker)||(g&&!h&&(p.__gaTracker("require","ecommerce","ecommerce.js"),h=!0,this._log("loadGA","ecommerce")),p.__gaTracker("ecommerce:addTransaction",{id:a,affiliation:b,revenue:c,shipping:e,tax:d}),this._log("ecommerce:addTransaction",arguments))},this._addItem=function(a,b,c,d,e,f){angular.isUndefined(p.__gaTracker)||(p.__gaTracker("ecommerce:addItem",{id:a,name:b,sku:c,category:d,price:e,quantity:f}),this._log("ecommerce:addItem",arguments))},this._trackTrans=function(){angular.isUndefined(p.__gaTracker)||(p.__gaTracker("ecommerce:send"),this._log("ecommerce:send",arguments))},this._clearTrans=function(){angular.isUndefined(p.__gaTracker)||(p.__gaTracker("ecommerce:clear"),this._log("ecommerce:clear",arguments))},this._trackSocial=function(a,b,c){angular.isUndefined(p.__gaTracker)||(p.__gaTracker("send","social",{socialNetwork:a,socialAction:b,socialTarget:c}),this._log("trackSocial",arguments))},this._createScriptTag();var q=this;return c&&n.$on(f,function(){q._trackPage(o.path(),n.pageTitle)}),{_logs:q._logs,trackers:q.trackers,trackPage:function(a,b){q._trackPage(a,b)},trackEvent:function(a,b,c,d){q._trackEvent(a,b,c,d)},addTrans:function(a,b,c,d,e){q._addTrans(a,b,c,d,e)},addItem:function(a,b,c,d,e,f){q._addItem(a,c,b,d,e,f)},trackTrans:function(){q._trackTrans()},clearTrans:function(){q._clearTrans()},trackSocial:function(a,b,c){q._trackSocial(a,b,c)},ga:function(){angular.isDefined(p.__gaTracker)&&p.__gaTracker(arguments)}}}]});